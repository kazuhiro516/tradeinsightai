# 📈 AI分析レポート作成機能 要件定義

## 概要

トレーダーが指定した期間のトレード履歴データを分析し、AIが自然言語で詳細な分析レポートを作成して出力する機能を提供する。

## 目的

トレーダーが自身のトレードパフォーマンスを詳細に把握し、明確な改善点や評価ポイントを理解して次のトレードに活かせるよう支援する。

## ユーザー

- 個人FXトレーダー（特にXM Tradingユーザー）

## 機能詳細

### トレード履歴期間設定

- ユーザーが分析対象期間を自由に指定可能（例：YYYY/MM/DD〜YYYY/MM/DD）
- 設定された期間内のトレード履歴を対象に集計および分析を実施

### AI分析対象データ

以下のトレードデータを、以下の項目ごとに集計し分析対象とする。

- 市場時間ごと（東京・ロンドン・ニューヨーク・その他）
- 曜日ごと
- 取引タイプごと（買い・売り）
- 取引サイズごと
- 通貨ペアごと
- 損益ごと

具体的な指標：

- 総利益（Gross Profit）
- 総損失（Gross Loss）
- 純利益（Net Profit）
- 取引回数（Total Trades）
- 勝率（Win Rate）
- プロフィットファクター（Profit Factor）
- 平均利益・平均損失（Average Profit/Loss）
- 最大利益・最大損失（Largest Profit/Loss）
- 最大連勝・連敗数（Max Consecutive Wins/Losses）
- 最大ドローダウン（Maximal Drawdown）
- リスクリワード比率（Risk-Reward Ratio）

### レポート内容

AIが以下の内容を自然言語で分析・生成し、1枚のレポートにまとめる。

- 期間内のトレードパフォーマンスの総評
- 各指標に基づく具体的な改善点の提示
    - エントリー精度
    - エグジット精度
    - ポジションサイジングとリスク管理
- 継続すべき良好なトレード行動
- 今後のトレード改善に向けた具体的なアドバイス

### レポート出力形式

- PDF形式でダウンロード可能
- 画面上でもブラウザで閲覧可能

## 技術要件

- クライアント・サーバサイド共にNext.jsを利用
- トレード履歴データの解析・集計はサーバーサイド（Next.js API Routes）で実施
- 自然言語レポート生成にはOpenAI APIを使用
- PDF生成ライブラリとしてPDFKitまたは類似ライブラリを採用
- UIスタイリングにはTailwind CSSを使用

## UX/UI要件

- 分析対象期間設定用の直感的なインターフェース
- 分析処理の進捗状況をUI上で明確に表示する非同期処理
- 分析完了時に即座にレポートが表示されるリアクティブなUI
- 過去に生成したレポートの履歴参照機能
- レポートへのアクセスリンクをチャットインターフェース内に提供

## エラー処理とバリデーション

- 不適切な期間設定時（例：開始日が終了日より未来）の分かりやすいエラーメッセージ
- 分析対象となるトレードデータが不足している場合の通知と対応指示

## 非機能要件

- 分析処理は非同期で実行し、UI上で進捗状況をリアルタイムに表示
- レスポンシブデザインでモバイル・デスクトップ両方に対応
